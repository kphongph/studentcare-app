<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../../iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../paper-styles/typography.html">
<link rel="import" href="../../paper-radio-group/paper-radio-group.html">
<link rel="import" href="../../iron-validatable-behavior/iron-validatable-behavior.html">
<link rel="import" href="../../paper-radio-button/paper-radio-button.html">

<dom-module id="sdq-form-student">
  <template>
    <style include="iron-flex iron-flex-alignment iron-flex-factors">
      :host {
        @apply(--paper-font-body1);
        display: block;
        width:100%;
      }
      .invalid {
        border:1px solid red;
      }
      .question {
        padding:7px;
        background-color:var(--paper-grey-100);
      }
    </style>
     <div class="layout vertical">
      <div id="r_exist">
        <div class="question">
          โดยรวมคุณคิดว่าตัวเองมีปัญหาในด้านอารมณ์ ด้านสมาธิ ด้านพฤติกรรมหรือความสามารถเข้ากับผู้อื่น ด้านใดด้านหนึ่งหรือไม่
        </div>
        <paper-radio-group selected="{{value.exist}}">
          <paper-radio-button name="N">ไม่</paper-radio-button>
          <paper-radio-button name="Y">ใช่</paper-radio-button>
        </paper-radio-group>
      </div>      
      <div id="problemExist" class="layout vertical" hidden>
        <div id="r_level">  
        <div class="question">คุณมีปัญหาดังกล่าวในระดับ</div>
          <paper-radio-group selected="{{value.level}}">
           <paper-radio-button name="0">เล็กน้อย</paper-radio-button>
           <paper-radio-button name="1">ชัดเจน</paper-radio-button>
           <paper-radio-button name="2">อย่างรุนแรง</paper-radio-button>
          </paper-radio-group>
        </div>
       <div id="r_time">  
        <div class="question">ปัญหานี้เกิดขึ้นมานามเท่าไหร่แล้ว</div>
          <paper-radio-group selected="{{value.time}}">
           <paper-radio-button name="1m">น้อยกว่า 1 เดือน</paper-radio-button>
           <paper-radio-button name="1m-5m">1 - 5 เดือน</paper-radio-button>
           <paper-radio-button name="6m-1y">6 -12 เดือน</paper-radio-button>
           <paper-radio-button name="1y">มากกว่า 1 ปี</paper-radio-button>
          </paper-radio-group>
       </div>
       <div id="r_unhappy">  
        <div class="question"> คุณรู้สึกหงุดหงิดหรือไม่สบายใจกับปัญหาที่มีหรือไม่</div>
          <paper-radio-group selected="{{value.unhappy}}">
            <paper-radio-button name="0">ไม่เลย</paper-radio-button>
            <paper-radio-button name="1">เล็กน้อย</paper-radio-button>
            <paper-radio-button name="2">ค่อนข้างมาก</paper-radio-button>
            <paper-radio-button name="3">มาก</paper-radio-button>
          </paper-radio-group>
       </div>
        <div id="r_life">  
        <div class="question">ปัญหานี้รบกวนชีวิตประจำวันของคุณในด้านความเป็นอยู่ที่บ้าน</div>        
          <paper-radio-group selected="{{value.life}}">
            <paper-radio-button name="0">ไม่เลย</paper-radio-button>
            <paper-radio-button name="1">เล็กน้อย</paper-radio-button>
            <paper-radio-button name="2">ค่อนข้างมาก</paper-radio-button>
            <paper-radio-button name="3">มาก</paper-radio-button>
          </paper-radio-group>
       </div>
       <div id="r_friend">
        <div class="question">ปัญหานี้รบกวนชีวิตประจำวันของคุณในด้านการคบเพื่อน</div>        
          <paper-radio-group selected="{{value.friend}}">
             <paper-radio-button name="0">ไม่เลย</paper-radio-button>
             <paper-radio-button name="1">เล็กน้อย</paper-radio-button>
             <paper-radio-button name="2">ค่อนข้างมาก</paper-radio-button>
             <paper-radio-button name="3">มาก</paper-radio-button>
          </paper-radio-group>
       </div>
       <div id="r_study">  
        <div class="question">ปัญหานี้รบกวนชีวิตประจำวันของคุณในด้านการเรียนในห้องเรียน</div>
          <paper-radio-group selected="{{value.study}}">
             <paper-radio-button name="0">ไม่เลย</paper-radio-button>
             <paper-radio-button name="1">เล็กน้อย</paper-radio-button>
             <paper-radio-button name="2">ค่อนข้างมาก</paper-radio-button>
             <paper-radio-button name="3">มาก</paper-radio-button>
          </paper-radio-group>
       </div>
       <div id="r_freetime">  
        <div class="question">ปัญหานี้รบกวนชีวิตประจำวันของคุณในด้านกิจกรรมยามว่าง</div>
          <paper-radio-group selected="{{value.freetime}}">
             <paper-radio-button name="0">ไม่เลย</paper-radio-button>
             <paper-radio-button name="1">เล็กน้อย</paper-radio-button>
             <paper-radio-button name="2">ค่อนข้างมาก</paper-radio-button>
             <paper-radio-button name="3">มาก</paper-radio-button>
          </paper-radio-group>
       </div>
       <div id="r_social">  
        <div class="question">ปัญหานี้ทำให้คยรอบข้างเกิดความยุ่งยากหรือไม่ (ครอบครัว เพื่อน ครู ฯลฯ)</div>
          <paper-radio-group selected="{{value.social}}">
             <paper-radio-button name="0">ไม่เลย</paper-radio-button>
             <paper-radio-button name="1">เล็กน้อย</paper-radio-button>
             <paper-radio-button name="2">ค่อนข้างมาก</paper-radio-button>
             <paper-radio-button name="3">มาก</paper-radio-button>
          </paper-radio-group>
       </div>
      </div>    
  </template>

  <script>
    Polymer({
      is: 'sdq-form-student',
      properties: {
        value:{
          type:Object,
          notify:true,
          value:function() {
            return {};
          }
        }
      },
      behaviors:[ 
        Polymer.IronValidatableBehavior
      ],
      observers: [
        '_existChanged(value.exist)',
      ],
      _existChanged: function(exist) {
        if(exist){
          var dict = {
            'Y': true,
            'N': false
          };              
          this.$.problemExist.hidden = !dict[exist];
        }
      },
      _getValidity: function() {
        var obj = this.value;
        var self = this;
         
        var __check = function(attr) {
          if(!obj[attr]) {
             self.$['r_'+attr].classList.add('invalid');
             return false;
          } else {
             self.$['r_'+attr].classList.remove('invalid');
          }
          return true;
        }
        
        if(!obj.exist) {
          this.$.r_exist.classList.add('invalid');
          return false;
        } else {
          if(obj.exist == 'Y') {
            this.$.r_exist.classList.remove('invalid');
            var attrs = ['level','time',
              'unhappy','friend','study','social'];
            for(var i=0;i<attrs.length;i++) {
              if(!__check(attrs[i])) { 
                return false;
              }
            }
          }
        }
        console.log('pass');
        return true;
      }
    });
  </script>
</dom-module>
