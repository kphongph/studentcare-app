<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../../iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../iron-icons/iron-icons.html">
<link rel="import" href="../../iron-validatable-behavior/iron-validatable-behavior.html">
<link rel="import" href="../../paper-styles/typography.html">
<link rel="import" href="../../paper-radio-group/paper-radio-group.html">
<link rel="import" href="../../paper-radio-button/paper-radio-button.html">
<link rel="import" href="../form-control.html">
<link rel="import" href="../studentcare-form-behavior.html">
<link rel="import" href="eq-teacher-choice.html">

<dom-module id="eq-teacher-form">
  <template>
    <style include="iron-flex iron-flex-alignment iron-flex-factors">
      :host {
        @apply(--paper-font-display);
        @apply(--layout-vertical);
        display: block;
      }

      .invalid {
        border: 1px solid #ee0000;
      }

      .formEntry div {
        @apply(--paper-font-title);
        margin:3px;
        padding:0px;
        background:#efefef;
      }
      
      .description ol {
        @apply(--paper-font-body1);
        .num {list-style-type: decimal;}
        margin:3px;
        padding:0px;
        background:#efefef;
      }
      .check-icon {
        width:30px;
      }
      .mark {
        font-weight:bold;
      }
    </style>

    <form-control id="control"
      on-form-action="_tap"
      doc-key="{{document.key}}"
      doc-value="{{document.value}}">
      <div class="description">
        <ol class="num"><b><u>ความหมาย</u></b>
          <li>ความฉลาดทางอารมณ์ของเด็กเป็นความพร้อมทางอารมณ์ที่จะอยู่ร่วมกับผู้อื่นได้อย่างราบรื่น โดยรู้จักอารมณ์ตนเองและผู้อื่น แสดงความเห็นใจหรือปลอบใจผู้อื่น อดทนและรอคอยได้ มีน้ำใจ รู้จักให้ รู้จักแบ่งปัน รู้ว่าทำผิด หรือยอมรับผิด พร้อมที่จะพัฒนาตนไปสู่ความสำเร็จ โดยมีความกระตือรือร้น สนใจใฝ่รู้ และปรับตัวต่อการเปลี่ยนแปลง พร้อมทำให้ตนเองเกิดความสุข โดยมีความพอใจ ความอบอุ่นใจ และความสนุกสนานร่าเริง</li>
        </ol>
        <ul class="num"><b><u>คำชี้แจง</u></b>
          <li>ให้ครูตอบคำถามที่เกี่ยวกับเด็กในช่วง 4 เดือนที่ผ่านมา โดยเลือกคำตอบที่ใกล้เคียงกับตัวเด็กที่เป็นอยู่จริงมากที่สุด ในข้อคำถามแต่ละข้อมีคำตอบที่เป็นไปได้ 4 คำตอบ </li>
          <li>"ไม่เป็นเลย"  	หมายถึง	ไม่เคยปรากฏ</li>
          <li>"เป็นบางครั้ง" 	หมายถึง	นานๆครั้งหรือทำบ้างไม่ทำบ้าง</li>
          <li>"เป็นบ่อยครั้ง" 	หมายถึง 	ทำบ่อยๆหรือเกือบทุกครั้ง</li>
          <li>"เป็นประจำ"  	หมายถึง	ทำทุกครั้งเมื่อเกิดสถานการณ์นั้น</li>
        </ul>
        <ol class="num"> <b><u>วิธีการประเมินและข้อพึงระวัง</u></b>
          <li>ครูประเมินความฉลาดทางอารมณ์เด็กในภาคการศึกษาที่ 2 หรือหลังจากคุ้นเคยกับนักเรียนอย่างน้อย 4 เดือน</li>
          <li>ผลการประเมินเป็นคะแนนของเด็กรายบุคคล ไม่ควรนำไปเปรียบเทียบกับเด็กอื่น ว่ากล่าวตำหนิเด็กหรือใช้เป็นข้อตัดสินในการคัดเลือกเด็ก</li>
        </ol>
        <ol class="num"><b><u>การให้คะแนน</u></b>  แบ่งเป็น 2 กลุ่ม
          <li>  กลุ่มที่ 1
            <ul class="num">ให้คะแนนแต่ละข้อดังนี้
              <li>ข้อ 1 ,2 ,4 ,5 ,6 ,7 ,9 ,10 ,11 ,12 ,13 ,14 ,15</li>
              <li>"ไม่เป็นเลย"  ให้	1 คะแนน</li>
              <li>"เป็นบางครั้ง" ให้	2 คะแนน</li>
              <li>"เป็นบ่อยครั้ง" ให้ 3 คะแนน</li>
              <li>"เป็นประจำ" ให้ 4 คะแนน</li>
            </ul>
          </li>
          <li> กลุ่มที่ 2
            <ul class="num">ให้คะแนนแต่ละข้อ 3 และ 8 
              <li>"ไม่เป็นเลย"  ให้	4 คะแนน</li>
              <li>"เป็นบางครั้ง" ให้	3 คะแนน</li>
              <li>"เป็นบ่อยครั้ง" ให้ 2 คะแนน</li>
              <li>"เป็นประจำ" ให้ 1 คะแนน</li>
            </ul>
          </li>
        </ol>
        <ul class="num"><b><u> การแปลผล</u></b>
          <li>คะแนนรวม มากกว่า" 56 คะแนน ความฉลาดทางอารมณ์สูงกว่าปกติ</li>
          <li>คะแนนรวม มากกว่า	 42-56 คะแนน ความฉลาดทางอารมณ์ปานกลาง</li>
          <li>คะแนนรวม มากกว่า  42 คะแนน ความฉลาดทางอารมณ์ต่ำกว่าปกติ</li>
        </ul>
        <ul class="num"><b><u>หมายเหตุ</u></b>
          <li>ก่อนและหลังประเมินครูควรจัดกิจกรรมส่งเสริมความฉลาดทางอารมณ์ เพื่อพัฒนาความฉลาดทางอารมณ์แก่เด็กอย่างต่อเนื่อง</li>
        </ul>
      </div>
     <div class="formEntry">
     <div>ดี</div> 
     <eq-teacher-choice value="{{document.value.form_value.q1}}" 
        label="รู้จักให้กำลังใจผู้อื่น">
     </eq-teacher-choice>
     <eq-teacher-choice value="{{document.value.form_value.q2}}" 
        label="รู้จักรับฟังความคิดเห็นของผู้อื่น">
     </eq-teacher-choice>
     <eq-teacher-choice value="{{document.value.form_value.q3}}" 
        label="ชอบแกล้งเพื่อน">
     </eq-teacher-choice>
     <eq-teacher-choice value="{{document.value.form_value.q4}}" 
        label="ยอมรับเมื่อทำผิด เช่น ขอโทษหรือยกมือไหว้">
     </eq-teacher-choice>
     <eq-teacher-choice value="{{document.value.form_value.q5}}" 
        label="ทักทายหรือทำความรู้จักกับเพื่อนใหม่ ">
     </eq-teacher-choice>
     <div>เก่ง</div>
     <eq-teacher-choice value="{{document.value.form_value.q6}}" 
        label="มีความตั้งใจเมื่อทำสิ่งต่างๆ ที่สนใจ">
     </eq-teacher-choice>
     <eq-teacher-choice value="{{document.value.form_value.q7}}" 
        label="พยายามทำงานที่ยากให้สำเร็จได้ด้วยตนเอง เช่น การบ้าน งานฝีมือ">
     </eq-teacher-choice>
     <eq-teacher-choice value="{{document.value.form_value.q8}}" 
        label="ท้อใจหรือล้มเลิกความตั้งใจเมื่อทำงานไม่สำเร็จ หรือเมื่อมีปัญหา">
     </eq-teacher-choice>
     <eq-teacher-choice value="{{document.value.form_value.q9}}" 
        label="รู้จักรอคอยเวลาที่เหมาะสมในการแก้ปัญหา เช่นเมื่อไม่ได้ในสิ่งที่ต้องการ">
     </eq-teacher-choice>
     <eq-teacher-choice value="{{document.value.form_value.q10}}" 
        label="เมื่อมีปัญหา ชอบคิดหาวิธีแก้ปัญหาหลายๆทาง">
     </eq-teacher-choice>
     <div>สุข</div>
     <eq-teacher-choice value="{{document.value.form_value.q11}}" 
        label="ภูมิใจในจุดดีของตนเอง">
     </eq-teacher-choice>
     <eq-teacher-choice value="{{document.value.form_value.q12}}" 
        label="มีอารมณ์ขัน">
     </eq-teacher-choice>
     <eq-teacher-choice value="{{document.value.form_value.q13}}"
        label="ทำกิจกรรมสร้างสุขให้ตนเองได้อย่างเหมาะสม">
     </eq-teacher-choice>
     <eq-teacher-choice value="{{document.value.form_value.q14}}"
        label="มีวิธีผ่อนคลายความเครียดด้วยตนเอง เช่นอ่านหนังสือ ดูหนัง ฟังเพลง เล่นสนุก วาดรูป พูดคุยกับเพื่อน">
     </eq-teacher-choice>
     <eq-teacher-choice value="{{document.value.form_value.q15}}"
        label="เป็นเด็กอารมณ์ดี">
     </eq-teacher-choice>
     </div>

     <div class="evaluation">
      <div class="layout vertical"> 
       <div class="layout horizontal">
        <div class="check-icon">
          <iron-icon icon="check" hidden$="{{!_criteria.c1}}">
          </iron-icon>
        </div>
        <span class="flex" id="c1_label">
          คะแนนรวม มากกว่า 56 คะแนน ความฉลาดทางอารมณ์สูงกว่าปกติ
        </span>
       </div>
       <div class="layout horizontal">
        <div class="check-icon">
          <iron-icon icon="check" hidden$="{{!_criteria.c2}}">
          </iron-icon>
        </div>
        <span class="flex" id="c2_label">
          คะแนนรวม มากกว่า 42-56 คะแนน ความฉลาดทางอารมณ์ปานกลาง
        </span>
       </div>
       <div class="layout horizontal">
        <div class="check-icon">
          <iron-icon icon="check" hidden$="{{!_criteria.c3}}">
          </iron-icon>
        </div>
        <span class="flex" id="c3_label">
          คะแนนรวม ต่ำกว่า 42 คะแนน ความฉลาดทางอารมณ์ต่ำกว่าปกติ
        </span>
       </div>
      </div>
     </div>
    </form-control>

  </template>

  <script>
    Polymer({
      is: 'eq-teacher-form',
      properties: {
        name: {
          type:String,
          reflectToAttribute:true,
          value:"แบบประเมินความฉลาดทางอารมณ์ (EQ)ฉบับครูประเมินนักเรียน (6-11 ปี)"
        }
      },
      observers:[
        '_result(document.value.form_result.score)'
      ],
      behaviors:[
        Polymer.IronValidatableBehavior,
        StudentcareFormBehavior,
      ],
      _tap:function(e) {
        if(e.detail.type == "save") {
          this.$.control.save();
        }
      },
      _evaluate:function() {
        var values = this.document.value.form_value;
        var score_list = ['','n','s','u','a'];
        var score38_list = ['','a','u','s','n'];
        var score = 0;
        for(var q in values) {
          if(q == 'q3' || q == 'q8') {
            score+=score38_list.indexOf(values[q]);
          } else {
            score+=score_list.indexOf(values[q]);
          }
        }
        return {'score':score};
      },
      _validate:function() {
        var eles =Polymer.dom(this.root)
         .querySelectorAll('eq-teacher-choice');
        for(var i=0;i<eles.length;i++) {
          if(!eles[i].value)  {
            eles[i].classList.add('invalid');
            return false;
          } else {
            eles[i].classList.remove('invalid');
          }
        }
        return true;
      },
      _reset:function() {
        this.set('document.value.form_value',{});
      },
      _result:function(score) {
        var _criteria = {'c1':false,'c2':false,'c3':false};
        if(score>=56) {
          _criteria.c1 = true;
        } else {
          if(score>=42) {
            _criteria.c2 = true;
          } else {
            _criteria.c3 = true;
          }
        }
        for(var key in _criteria) {
          if(_criteria[key]) {
            this.$$('#'+key+'_label').classList.add('mark');
          } else {
            this.$$('#'+key+'_label').classList.remove('mark');
          }
        }
        this.set('_criteria',_criteria);
      }
    });
  </script>
</dom-module>
