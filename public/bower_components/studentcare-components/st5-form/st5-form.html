<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../../iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../iron-icons/iron-icons.html">
<link rel="import" href="../../iron-validatable-behavior/iron-validatable-behavior.html">
<link rel="import" href="../../paper-styles/typography.html">
<link rel="import" href="../../paper-radio-group/paper-radio-group.html">
<link rel="import" href="../form-control.html">
<link rel="import" href="../studentcare-form-behavior.html">
<link rel="import" href="./st5-choice.html">
<dom-module id="st5-form">
  <template>
    <style include="iron-flex iron-flex-alignment iron-flex-factors">
      :host {
        @apply(--paper-font-display);
        @apply(--layout-vertical);
        display: block;
      }
      .invalid {
        border: 1px solid #ee0000;
      }
      paper-radio-group {
        background:#efefef;
      }
      .formEntry div {
        @apply(--paper-font-title);
        margin:3px;
        padding:0px;
        background:#efefef;
      }
      .description ol {
        @apply(--paper-font-body1);
        .num {list-style-type: decimal;}
        margin:3px;
        padding:0px;
        background:#efefef;
      }
      .evaluation {
        padding:5px;
      }
    </style>

    <form-control id="control"
      doc-key="{{document.key}}"
      doc-value="{{document.value}}">
      <div class="description">
        <ul class="num"><b><u>การแปลผล</u></b>
          <li>0–4 คะแนน  เครียดน้อย </li>
          <li>5–7 คะแนน เครียดปานกลาง  </li>
          <li>8–9 คะแนน เครียดมาก</li>
          <li>10-15 คะแนน เครียดมากที่สุด</li>
        </ul>
        <ol class="num"><b><u>คำอธิบาย</u></b>
          <li> <b>เครียดน้อย</b> เป็นความเครียดในชีวิตประจำวัน ซึ่งแต่ละคน สามารถปรับตัวได้เอง ไม่เกิดปัญหาสุขภาพของตนเอง และท่านยังสามารถช่วยดูแลบุคคลอื่นๆ ในครอบครัวและชุมชนได้ด้วย</li>
          <li> <b>เครียดปานกลาง  (ถือว่าเป็นปกติ)</b>  ในภาวะวิกฤติ  หรือภัยพิบัติ ๆ จะทำให้บุคคลต้องเตรียมพร้อมในการจัดการกับปัญหาต่างๆ จนทำให้เกิดความเครียดเพิ่มขึ้นในระดับปานกลาง ซึ่งยังถือว่าเป็นปกติ เพราะทำให้เกิดความกระตือรือร้นในการเผชิญปัญหา</li>
          <li> <b>เครียดมาก(ต้องหาวิธีจัดการความเครียด) </b>ในภาวะวิกฤติหรือภัยพิบัติต่างๆ อาจทำให้เกิดการตอบสนองที่รุนแรงขึ้นชั่วคราว  ซึ่งมักจะลดลงมาเป็นปกติหลังเหตุการณ์  </li>
          <ul class="num"><b> แนะนำการจัดการกับความเครียด ดังต่อไปนี้ </b>
            <li>การฝึกการหายใจ คลายเครียด (หายใจเข้าท้องพอง หายใจออกท้องแฟบ)    โดยการสาธิตและให้ฝึกปฎิบัติ</li>
            <li>การพูดคุยกับคนใกล้ชิด การสวดมนต์ไหว้พระ การช่วยเหลือผู้อื่นที่ประสบปัญหา จะทำให้ความเครียดลดลง</li>
            <li>การมีความหวังว่า เราจะฝ่าฟันอุปสรรคหรือปัญหาครั้งนี้ไปได้ และมองเห็นด้านบวก (มองในแง่ดี) ซึ่งอย่างน้อยก็ยังรักษาชีวิตไว้ได้  มีคนเห็นอกเห็นใจ และมีการช่วยเหลือจากฝ่ายต่าง ๆ</li>
            <li>มองข้ามความขัดแย้งเก่า ๆ ในอดีต และรวมตัวกันช่วยให้ชุมชนผ่านวิกฤติไปได้</li>
            <li>ภายใน 2 สัปดาห์ ท่านควรไปพบแพทย์เพื่อประเมินซ้ำว่าความเครียดลดลงหรือไม่  เพราะความเครียดที่มากและต่อเนื่องนำไปสู่โรควิตกกังวล  ภาวะซึมเศร้า และเสี่ยงต่อการฆ่าตัวตายได้ ซึ่งจะต้องได้รับการรักษาจากแพทย์</li>
          </ul>
          <li><b>เครียดมากที่สุด  (พบแพทย์)</b> เป็นความเครียดที่รุนแรงซึ่งส่งผลกระทบต่อภาวะร่างกาย  ทำให้อ่อนแอเจ็บป่วยง่าย  และมีผลกระทบต่อภาวะจิตใจ  จนอาจทำให้เกิดโรควิตกกังวล  ภาวะซึมเศร้า และเสี่ยงต่อการฆ่าตัวตาย <u>จะต้องได้รับการรักษาจากแพทย์ทันที และได้รับการดูแลต่อเนื่องไปอีก 3 – 6 เดือน</u></li>
        </ol>
        <ul class="num"><b><u>หมายเหต</u></b>
          <li>ให้ผู้ถูกประเมินตอบให้ตรงตามความรู้สึก ในระยะ 2 – 4 สัปดาห์ </li>
        </ul>
      </div>
      <div class="formEntry">
        <st5-choice id="q1" value="{{document.value.form_value.q1}}"
          label="มีปัญหาการนอน นอนไม่หลับ หรือนอนมาก">
        </st5-choice>
        <st5-choice id="q2" value="{{document.value.form_value.q2}}"
          label="มีสมาธิน้อยลง">
        </st5-choice>
        <st5-choice id="q3" value="{{document.value.form_value.q3}}"
          label="หงุดหงิด / กระวนกระวายใจ / ว้าวุ่นใจ">
        </st5-choice>
        <st5-choice id="q4" value="{{document.value.form_value.q4}}"
          label="รู้สึกเบื่อ  เซ็ง">
        </st5-choice>
        <st5-choice id="q5" value="{{document.value.form_value.q5}}"
          label="ไม่อยากพบปะผู้คน">
        </st5-choice>
      </div>
      <div class="evaluation">
       <div class="layout horizontal">
        <paper-input label="คะแนนรวม 5 ข้อ ได้ (คะแนน)" class="flex"
          readonly
          value="[[document.value.form_result.score]]">
        </paper-input>
        <paper-input label="ระดับความเครียด" class="flex"
          readonly
          value="[[_result(document.value.form_result.score)]]">
        </paper-input>
       </div>
      </div>
    </form-control>
  </template>
  <script>
    Polymer({
      is: 'st5-form',
      properties: {
        name: {
          type:String,
          reflectToAttribute:true,
          value:"แบบประเมินความเครียดกรมสุขภาพจิต (ST–5)"
        }
      },
      behaviors:[
        Polymer.IronValidatableBehavior,
        StudentcareFormBehavior,
      ],
      _evaluate:function() {
        var values = this.document.value.form_value;
        var dict = ['n','s','u','a'];
        var score = 0;
        for(var key in values) {
          score+=dict.indexOf(values[key]);
        }
        return {'score':score};
      },
      _reset:function() {
        this.set('document.value.form_value',{});              
        this.set('document.value.form_result',{});              
      },
      _validate:function() {
        var questions = this.document.value.form_value;
        var required = ['q1','q2','q3','q4','q5']; 
        for(var i=0;i<required.length;i++) {
          if(!questions[required[i]]) {
            this.$$('#'+required[i]).classList.add('invalid'); 
            return false;
          } else {
            this.$$('#'+required[i]).classList.remove('invalid'); 
          }
        }
        return true;
      },
      _result:function(score) {
        if(score>=0) {
          if(score<5) return 'เครียดน้อย';
          if(score<8) return 'เครียดปานกลาง';
          if(score<10) return 'เครียดปานกลาง';
          return 'เครียดมากที่สุด';
        } 
        return '';
      }
    });
  </script>
</dom-module>
